// संस्कृत-स्रोत: शब्द-विभाजक (टोकनाइज़र) कंकाल

संरचना अक्षर_धारा {
  मूल: श्रृंखला
  स्थान: पूर्ण64
}

गण चिह्न {
  रिक्त
  परिचायक       // पहचानकर्ता
  पूर्णांक       // 0,1,2...
  दशांश         // 1.23
  लेख्य          // "पाठ"
  चिह्न_खुला     // (
  चिह्न_बन्द     // )
  आकृति_खुली     // {
  आकृति_बन्द     // }
  सूची_खुली       // [
  सूची_बन्द       // ]
  सम             // सम (समानता)
  असम            // असमानता
  अल्पविराम      // ,
  द्विबिन्दु       // :
  जोड़           // +
  घट             // -
  गुण             // *
  भाग             // /
  कम              // लघु
  अधिक            // महान्
  लघु_सम         // ≤ (लघु-सम)
  महान्_सम       // ≥ (महान्-सम)
  तर्क_च         // AND (च)
  तर्क_वा        // OR  (वा)
  निषेध          // NOT (न)
  विराम           // ;
  शब्द_समाप्त     // EOF
}

संरचना टोकन {
  प्रकार: चिह्न
  पाठ्य: श्रृंखला
  आरम्भ: पूर्ण64
  अन्त: पूर्ण64
}

// देवनागरी-अङ्क-परीक्षकः: '०'..'९'
कार्य देव_अंक(च: अक्षर): तर्क {
  लौटय (च >= '०' और च <= '९')
}

कार्य आरम्भ_धारा(पाठ: श्रृंखला): अक्षर_धारा {
  लौटय अक्षर_धारा{मूल: पाठ, स्थान: 0}
}

कार्य अग्रम्(धारा: &अक्षर_धारा): वैकल्पिक<अक्षर> {
  यदि (धारा.स्थान >= दीर्घता(धारा.मूल)) { लौटय रिक्त }
  लौटय धारा.मूल[धारा.स्थान]
}

कार्य ग्रहण(धारा: &अक्षर_धारा): वैकल्पिक<अक्षर> {
  यदि (धारा.स्थान >= दीर्घता(धारा.मूल)) { लौटय रिक्त }
  अयं = धारा.मूल[धारा.स्थान]
  धारा.स्थान = धारा.स्थान + 1
  लौटय अयं
}

कार्य लंघय_श्वेत(धारा: &अक्षर_धारा): शून्य {
  जबतक (सत्य) {
    अ = अग्रम्(धारा)
    यदि (अ == रिक्त) { टूटो }
    यदि (अ == ' ' या अ == '\n' या अ == '\t' या अ == '\r') { ग्रहण(धारा); जारी }
    अन्यथा { टूटो }
  }
}

कार्य टोकन_अगला(धारा: &अक्षर_धारा): टोकन {
  लंघय_श्वेत(धारा)
  आरम्भ = धारा.स्थान
  अ = ग्रहण(धारा)
  यदि (अ == रिक्त) { लौटय टोकन{प्रकार: शब्द_समाप्त, पाठ्य: "", आरम्भ: आरम्भ, अन्त: आरम्भ} }

  यदि (अ == '(') { लौटय टोकन{प्रकार: चिह्न_खुला, पाठ्य: "(", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == ')') { लौटय टोकन{प्रकार: चिह्न_बन्द, पाठ्य: ")", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == '{') { लौटय टोकन{प्रकार: आकृति_खुली, पाठ्य: "{", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == '}') { लौटय टोकन{प्रकार: आकृति_बन्द, पाठ्य: "}", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == '[') { लौटय टोकन{प्रकार: सूची_खुली, पाठ्य: "[", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == ']') { लौटय टोकन{प्रकार: सूची_बन्द, पाठ्य: "]", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == '।') { लौटय टोकन{प्रकार: विराम, पाठ्य: "।", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == ',') { लौटय टोकन{प्रकार: अल्पविराम, पाठ्य: ",", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
  यदि (अ == ':') { लौटय टोकन{प्रकार: द्विबिन्दु, पाठ्य: ":", आरम्भ: आरम्भ, अन्त: धारा.स्थान} }

  // पहचानकर्ता/संख्या स्कैनिंग (सरलीकृत)
  यदि (अक्षर_अक्षरीय(अ) या अ == '_') {
    जबकि (सत्य) {
      प = अग्रम्(धारा)
      // देवनागरी-शब्द में '-' को मध्यस्थ-चिह्नरूपेण स्वीकारयामः
      यदि (प != रिक्त और (अक्षर_अक्षरीय(प) या अंक(प) या प == '_' या प == '-')) { ग्रहण(धारा); जारी } अन्यथा { टूटो }
    }
    लेख = उपस्ट्रिंग(धारा.मूल, आरम्भ, धारा.स्थान)
    // संस्कृत-शब्द-ऑपरेटर/ब्लॉक-कीवर्ड मानचित्रण
    यदि (लेख == "योग") { लौटय टोकन{प्रकार: जोड़, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "घट") { लौटय टोकन{प्रकार: घट, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "गुण") { लौटय टोकन{प्रकार: गुण, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "भाग") { लौटय टोकन{प्रकार: भाग, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "लघु") { लौटय टोकन{प्रकार: कम, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "महान्") { लौटय टोकन{प्रकार: अधिक, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "लघु-सम") { लौटय टोकन{प्रकार: लघु_सम, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "महान्-सम") { लौटय टोकन{प्रकार: महान्_सम, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "सम") { लौटय टोकन{प्रकार: सम, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "असम") { लौटय टोकन{प्रकार: असम, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "च") { लौटय टोकन{प्रकार: तर्क_च, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "वा") { लौटय टोकन{प्रकार: तर्क_वा, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "न") { लौटय टोकन{प्रकार: निषेध, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "आरम्भ") { लौटय टोकन{प्रकार: आकृति_खुली, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    यदि (लेख == "समाप्ति") { लौटय टोकन{प्रकार: आकृति_बन्द, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान} }
    लौटय टोकन{प्रकार: परिचायक, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान}
  }

  // केवल देवनागरी-अंक स्वीकार्य
  यदि (देव_अंक(अ)) {
    जबकि (देव_अंक(अग्रम्(धारा))) { ग्रहण(धारा) }
    यदि (अग्रम्(धारा) == '.') { ग्रहण(धारा); जबकि (देव_अंक(अग्रम्(धारा))) { ग्रहण(धारा) }; प्रकार = दशांश } अन्यथा { प्रकार = पूर्णांक }
    लेख = उपस्ट्रिंग(धारा.मूल, आरम्भ, धारा.स्थान)
    लौटय टोकन{प्रकार: प्रकार, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान}
  }

  यदि (अ == '"') {
    जबकि (अग्रम्(धारा) != रिक्त और अग्रम्(धारा) != '"') { ग्रहण(धारा) }
    यदि (अग्रम्(धारा) == '"') { ग्रहण(धारा) }
    लेख = उपस्ट्रिंग(धारा.मूल, आरम्भ+1, धारा.स्थान-1)
    लौटय टोकन{प्रकार: लेख्य, पाठ्य: लेख, आरम्भ: आरम्भ, अन्त: धारा.स्थान}
  }

  // अज्ञात अक्षर → एकल टोकन
  पाठ = उपस्ट्रिंग(धारा.मूल, आरम्भ, धारा.स्थान)
  लौटय टोकन{प्रकार: परिचायक, पाठ्य: पाठ, आरम्भ: आरम्भ, अन्त: धारा.स्थान}
}


